---
title: "Functions and Datasets"
author: "Jason T. Serviss"
date: "30/11/2016"
output:
    html_document:
        theme: flatly
        toc: yes
---

<style>
    .col2 {
        columns: 2 200px;         /* number of columns and width in pixels*/
        -webkit-columns: 2 200px; /* chrome, safari */
        -moz-columns: 2 200px;    /* firefox */
    }
</style>

#Introduction
This document is to highlight the capability of the functions used for testing the ClusterSignificance package.

<br></br>

```{r setup, include=FALSE, message=FALSE}
library(ClusterSignificanceTesting)
library(printr)
library(knitr)

##the function below allows dynamic insertion of the function source code 
insert_fun = function(name) {
    read_chunk(
      lines = capture.output(dump(name, '')), 
      labels = paste(name, 'source', sep = '-')
    )
}

```

```{r, echo=FALSE}
#sensitivity specificity and general functions
makeMatrix <- ClusterSignificanceTesting::makeMatrix
insert_fun("makeMatrix")

makeGroups <- ClusterSignificanceTesting::makeGroups
insert_fun("makeGroups")

overlapProbability <- ClusterSignificanceTesting::overlapProbability
insert_fun("overlapProbability")

.savePointsOverlaps <- ClusterSignificanceTesting:::.savePointsOverlaps
insert_fun(".savePointsOverlaps")

.createMatAndGroups <- ClusterSignificanceTesting:::.createMatAndGroups
insert_fun(".createMatAndGroups")

dynamicXY <- ClusterSignificanceTesting::dynamicXY
insert_fun("dynamicXY")

calculateOverlap <- ClusterSignificanceTesting::calculateOverlap
insert_fun("calculateOverlap")

addOnePoint <- ClusterSignificanceTesting::addOnePoint
insert_fun("addOnePoint")

interspersion <- ClusterSignificanceTesting::interspersion
insert_fun("interspersion")

checkIdenticalDims <- ClusterSignificanceTesting::checkIdenticalDims
insert_fun("checkIdenticalDims")

checkIdenticalMatrix <- ClusterSignificanceTesting::checkIdenticalMatrix
insert_fun("checkIdenticalMatrix")

overlapMatrices <- ClusterSignificanceTesting::overlapMatrices
insert_fun("overlapMatrices")

zeroOrHundred <- ClusterSignificanceTesting::zeroOrHundred
insert_fun("zeroOrHundred")

sensitivityTest <- ClusterSignificanceTesting::sensitivityTest
insert_fun("sensitivityTest")

specificityTest <- ClusterSignificanceTesting::specificityTest
insert_fun("specificityTest")

matrixTests <- ClusterSignificanceTesting::matrixTests
insert_fun("matrixTests")

.regenerate <- ClusterSignificanceTesting:::.regenerate
insert_fun(".regenerate")

#hematologicalCancers and corresponding plotting functions
hematologicalCancers <- ClusterSignificanceTesting:::hematologicalCancers
insert_fun("hematologicalCancers")

.downloadAndProcessData <- ClusterSignificanceTesting:::.downloadAndProcessData
insert_fun(".downloadAndProcessData")

.annotateBiotypes <- ClusterSignificanceTesting:::.annotateBiotypes
insert_fun(".annotateBiotypes")

.filterLongNonCoding <- ClusterSignificanceTesting:::.filterLongNonCoding
insert_fun(".filterLongNonCoding")

.renamePhenos <- ClusterSignificanceTesting:::.renamePhenos
insert_fun(".renamePhenos")

.runTsne <- ClusterSignificanceTesting:::.runTsne
insert_fun(".runTsne")

.runPcp <- ClusterSignificanceTesting:::.runPcp
insert_fun(".runPcp")

##tsnePlots
tsnePlots <- ClusterSignificanceTesting:::tsnePlots
insert_fun("tsnePlots")

.dimX <- ClusterSignificanceTesting:::.dimX
insert_fun(".dimX")

.dimY <- ClusterSignificanceTesting:::.dimY
insert_fun(".dimY")

.dimZ <- ClusterSignificanceTesting:::.dimZ
insert_fun(".dimZ")

##normalMDS plots
normalMDS <- ClusterSignificanceTesting:::normalMDS
insert_fun("normalMDS")

.view1 <- ClusterSignificanceTesting:::.view1
insert_fun(".view1")

.view2 <- ClusterSignificanceTesting:::.view2
insert_fun(".view2")

.view3 <- ClusterSignificanceTesting:::.view3
insert_fun(".view3")
```

# General and specificity/sensitivity testing functions {.tabset}
## Lower level functions {.tabset}
###makeMatrix
```{r}
help('makeMatrix')
```

####Source code
```{r, makeMatrix-source}
```

###makeGroups
```{r}
help('makeGroups')
```

```{r, makeGroups-source}
```

###overlapProbability
```{r}
help(overlapProbability)
```

```{r, overlapProbability-source}
```

#### .savepointsOverlaps
```{r, .savePointsOverlaps-source}
```

#### .createMatAndGroups
```{r, .createMatAndGroups-source}
```

###dynamicXY
```{r}
help('dynamicXY')
```

```{r, dynamicXY-source}
```

###addOnePoint
```{r}
help('addOnePoint')
```

```{r, addOnePoint-source}
```

<br></br><br></br><br></br>

## Matrix Checks {.tabset}
###calculateOverlap
```{r}
help('calculateOverlap')
```

```{r, calculateOverlap-source}
```

###interspersion
```{r}
help(interspersion)
```

```{r, interspersion-source}
```

An example of **interspersion**:
<div class="col2">
```{r, message=FALSE}
mat <- makeMatrix(x=c(0,1), y=c(0,1), dim=2, points=10, seed=15)
groups <- makeGroups(mat, names=c("g1", "g2"))
visualizeOverlaps(mat, groups, plotType="points")
interspersion(mat, groups, 1)

mat <- makeMatrix(x=c(0,1), y=c(0.9,0.95), dim=2, points=10, seed=15)
groups <- makeGroups(mat, names=c("g1", "g2"))
visualizeOverlaps(mat, groups, plotType="points")
interspersion(mat, groups, 1)
```
</div>

We can see that in the first example (left) that group 2 is highly interspersed within group 1 and therefore, the interspersion score is high. On the other hand, in the second example (right) group 2 has a low interspersion within group 1 and, therefore, the interspersion score is low.

###checkIdenticalDims
```{r}
help('checkIdenticalDims')
```

```{r, checkIdenticalDims-source}
```

An example of **checkIdenticalDims**:
<div class="col2">
```{r}
mat <- makeMatrix(x=c(0,1), y=c(0,1), dim=2, points=10)
names <- c("grp1", "grp2")
groups <- makeGroups(mat, names=names)
checkIdenticalDims(mat, groups)

spl1 <- split(mat[[1]][,1], groups)
spl2 <- split(mat[[1]][,2], groups)
mat <- list(matrix(c(spl1[[1]], spl1[[2]], spl1[[1]], spl2[[2]]), ncol=2))
checkIdenticalDims(mat, groups)
```
</div>

###checkIdenticalMatrix
```{r}
help('checkIdenticalMatrix')
```

```{r, checkIdenticalMatrix-source}
```

###checkIdenticalPoints
```{r}
help('checkIdenticalPoints')
```

```{r, checkIdenticalPoints-source}
```

###matrixTests
```{r}
help('matrixTests')
```

```{r, matrixTests-source}
```

#### .regenerate
```{r, .regenerate-source}
```

<br></br><br></br><br></br>

## Higher level functions {.tabset}
###overlapMatrices
```{r}
help('overlapMatrices')
```

```{r, overlapMatrices-source}
```

###zeroOrHundred
```{r}
help('zeroOrHundred')
```

```{r, zeroOrHundred-source}
```

###sensivitityTest
```{r}
help('sensitivityTest')
```

```{r, sensitivityTest-source}
```

###specificityTest
```{r}
help('specificityTest')
```

```{r, specificityTest-source}
```

# Hematological cancers functions {.tabset}
## Download and analysis functions {.tabset}
### hematologicalCancers
```{r}
help('hematologicalCancers')
```

```{r, hematologicalCancers-source}
```

#### .downloadAndProcessData
```{r, .downloadAndProcessData-source}
```

#### .annotateBiotypes
```{r, .annotateBiotypes-source}
```

#### .filterLongNonCoding
```{r, .filterLongNonCoding-source}
```

#### .renamePhenos
```{r, .renamePhenos-source}
```

#### .runTsne
```{r, .runTsne-source}
```

#### .runPcp
```{r, .runPcp-source}
```

## Plotting functions {.tabset}
### tsnePlots
```{r}
help('tsnePlots')
```

```{r, tsnePlots-source}
```

#### .dimX
```{r, .dimX-source}
```

#### .dimY
```{r, .dimY-source}
```

#### .dimZ
```{r, .dimZ-source}
```

### normalMDS
```{r}
help('normalMDS')
```

```{r, normalMDS-source}
```

#### .view1
```{r, .view1-source}
```

#### .view2
```{r, .view2-source}
```

#### .view3
```{r, .view3-source}
```

# Datasets {.tabset}

## Sensitivity / specificity testing datasets
```{r}
help('zero')
```

<br></br><br></br><br></br>

```{r}
help('hundred')
```

<br></br><br></br><br></br>

```{r}
help('sensitivityTestResults')
```

<br></br><br></br><br></br>

```{r}
help('specificityTestResults')
```

## Hematological cancer datasets
```{r}
help('hemCancData')
```

<br></br><br></br><br></br>

```{r}
help('lncGenes')
```

<br></br><br></br><br></br>

```{r}
help('pe')
```

